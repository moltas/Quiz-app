"use strict";var myApp=angular.module("myApp",["ngRoute","ngAnimate"]);myApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/landing_page.html",controller:"MainCtrl"}).when("/quiz",{templateUrl:"partials/questions.html",controller:"MainCtrl"}).when("/result_page",{templateUrl:"partials/result_page.html",controller:"resultsCtrl"}).when("/createquestion",{templateUrl:"partials/createQuestion.html",controller:"CreateQuestionCtrl"}).otherwise({redirectTo:"/"})}]);var myApp=angular.module("myApp");myApp.controller("MainCtrl",["$scope","$timeout","$rootScope","answerService","questions","$location","dataService",function(a,b,c,d,e,f,g){a.counter=0,a.playerScore=0;var h=null;c.runOnce=!1;var i=!1;a.questions=[];var j=function(){e.getQuestions().success(function(b){a.questions=b,h=a.questions.length-1})};j(),a.changeView=function(a){f.path(a)},a.$watch("counter",function(d){c.runOnce=!1,b(function(){i=!1},1e3),d>h&&(k(),a.changeView("/result_page"))}),a.next=function(){a.counter++},a.setCounter=function(b){a.counter=b},a.saveAnswer=function(e,f,g){var h=e.correct;if(d.questionAnswered(f),c.runOnce)var j=!1;else var j=e.selected=!0;d.checkAnswer(h,j,g)&&a.playerScore++,j&&b(function(){i===!1&&(a.next(),i=!0)},1500)};var k=function(){g.setData(a.playerScore),g.setLength(h+1)}}]),myApp.controller("headerCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),myApp.controller("resultsCtrl",["$scope","dataService",function(a,b){a.playerScore=b.data,a.questionLength=b.length,a.questionLength>1?a.percent=Math.floor(a.playerScore/a.questionLength*100):a.percent=0,a.showScores=function(a){return 100==a?"Grattis! Alla rätt!":a>=90?"Få besitter dina kunskaper om Westeros":a>=70?"Du är bättre än få":a>=50?"Du är lagomt dålig":"You know nothing, Jon Snow"},a.result=a.showScores(a.percent)}]),myApp.controller("CreateQuestionCtrl",["$scope","questions",function(a,b){a.correct1=!1,a.correct2=!1,a.correct3=!1,a.correct4=!1,a.questions=[];var c=function(){b.getQuestions().success(function(b){a.questions=b,console.log(a.questions.choices)})};c(),a.addQuestion=function(){a.question.choices=[],a.question.choices.push({text:a.option1,correct:a.correct1,selected:!1},{text:a.option2,correct:a.correct2,selected:!1},{text:a.option3,correct:a.correct3,selected:!1},{text:a.option4,correct:a.correct4,selected:!1}),b.postQuestion(a.question).success(function(){a.questions.push(a.question),a.question="",a.option1="",a.option2="",a.option3="",a.option4=""}),c()},a.deleteQuestion=function(a){b.deleteQuestion(a).success(function(){console.log("fire!.. Delete!"),c()})}}]);var myApp=angular.module("myApp");myApp.factory("answerService",["$rootScope",function(a){var b={checkAnswer:function(a,b,c){return a&&b?($("#"+c).addClass("right"),$(".answer").removeClass("blue"),!0):!a&&b?($("#"+c).addClass("wrong"),$(".answer").removeClass("blue"),!1):void 0},questionAnswered:function(b){for(var c=0;c<b.length;c++)b[c].selected&&(a.runOnce=!0,console.log("set to true"));a.runOnce&&$("label").click(!1)}};return b}]),myApp.factory("dataService",[function(){var a={};return a.setData=function(b){a.data=b},a.setLength=function(b){a.length=b},a}]),myApp.factory("questions",["$http",function(a){var b="/api/questions",c={};return c.getQuestions=function(){return a.get(b)},c.postQuestion=function(c){return a.post(b,c)},c.deleteQuestion=function(c){return a["delete"](b+"/"+c)},c}]),myApp.directive("greenOrRed",["$animate","answerService",function(a,b){return{restrict:"A",scope:{correct:"=",selected:"="},link:function(b,c,d){b.$watchGroup(["correct","selected"],function(b){var d=b[0],e=b[1];console.log(b[0]+" : "+b[1]),d&&e?a.addClass(c,"green"):!d&&e&&a.addClass(c,"red")})}}}]);